Program(MainMethod(MethodDecl(UnitType(),Identifier(main),List(),List(),List(),Println(Plus(StringLit(Polymorphism and Reference test suite ),MethodCall(New(Identifier(PolymorphismTest)),Identifier(run),List()))))),List(ClassDecl(Identifier(PolymorphismTest),None,List(),List(MethodDecl(StringType(),Identifier(run),List(),List(VarDecl(Identifier(Shape),Identifier(shape)), VarDecl(IntType(),Identifier(unit))),List(Assign(Identifier(shape),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(blue)))), Assign(Identifier(unit),MethodCall(Self(),Identifier(displayShape),List(Identifier(shape)))), Assign(Identifier(shape),MethodCall(New(Identifier(Rectangle)),Identifier(initRectangle),List(StringLit(red), IntLit(2), IntLit(4)))), Assign(Identifier(unit),MethodCall(Self(),Identifier(displayShape),List(Identifier(shape)))), Assign(Identifier(shape),MethodCall(New(Identifier(Square)),Identifier(initSquare),List(StringLit(yellow), IntLit(2)))), Assign(Identifier(unit),MethodCall(Self(),Identifier(displayShape),List(Identifier(shape)))), Assign(Identifier(shape),MethodCall(New(Identifier(Circle)),Identifier(init),List(StringLit(green)))), Assign(Identifier(unit),MethodCall(Self(),Identifier(displayShape),List(Identifier(shape)))), Println(StringLit(---------------------)), Assign(Identifier(unit),MethodCall(MethodCall(New(Identifier(Circle)),Identifier(initCircle),List(StringLit())),Identifier(drawTwice),List())), Println(StringLit(---------------------)), Assign(Identifier(unit),MethodCall(New(Identifier(ReferenceTest)),Identifier(run),List()))),StringLit(done)), MethodDecl(IntType(),Identifier(displayShape),List(Formal(Identifier(Shape),Identifier(shape))),List(VarDecl(StringType(),Identifier(text))),List(Assign(Identifier(text),Plus(StringLit(I am a ),MethodCall(Identifier(shape),Identifier(getColor),List()))), Assign(Identifier(text),Plus(Identifier(text),StringLit( ))), Assign(Identifier(text),Plus(Identifier(text),MethodCall(Identifier(shape),Identifier(getName),List()))), Println(Identifier(text))),MethodCall(Identifier(shape),Identifier(draw),List())))), ClassDecl(Identifier(ReferenceTest),None,List(),List(MethodDecl(IntType(),Identifier(run),List(),List(VarDecl(IntType(),Identifier(unit)), VarDecl(BooleanType(),Identifier(bool1)), VarDecl(BooleanType(),Identifier(bool2)), VarDecl(IntType(),Identifier(int1)), VarDecl(IntType(),Identifier(int2)), VarDecl(IntArrayType(),Identifier(intArr1)), VarDecl(IntArrayType(),Identifier(intArr2)), VarDecl(StringType(),Identifier(string1)), VarDecl(StringType(),Identifier(string2)), VarDecl(Identifier(Shape),Identifier(shape1)), VarDecl(Identifier(Shape),Identifier(shape2))),List(Assign(Identifier(bool1),True()), Assign(Identifier(bool2),False()), Assign(Identifier(unit),MethodCall(Self(),Identifier(swapBool),List(Identifier(bool1), Identifier(bool2)))), If(Identifier(bool1),Println(StringLit(bool1: true)),Some(Println(StringLit(bool1: false)))), If(Identifier(bool2),Println(StringLit(bool2: true)),Some(Println(StringLit(bool2: false)))), Assign(Identifier(int1),IntLit(1)), Assign(Identifier(int2),IntLit(2)), Assign(Identifier(unit),MethodCall(Self(),Identifier(swapInt),List(Identifier(int1), Identifier(int2)))), Println(Plus(StringLit(int1: ),Identifier(int1))), Println(Plus(StringLit(int2: ),Identifier(int2))), Assign(Identifier(intArr1),NewIntArray(IntLit(1))), Assign(Identifier(intArr2),NewIntArray(IntLit(2))), Assign(Identifier(unit),MethodCall(Self(),Identifier(swapIntArr),List(Identifier(intArr1), Identifier(intArr2)))), Println(Plus(StringLit(intArr1: ),ArrayLength(Identifier(intArr1)))), Println(Plus(StringLit(intArr2: ),ArrayLength(Identifier(intArr2)))), ArrayAssign(Identifier(intArr1),IntLit(0),IntLit(1)), ArrayAssign(Identifier(intArr2),IntLit(0),IntLit(2)), Assign(Identifier(unit),MethodCall(Self(),Identifier(swapIntArrValue),List(Identifier(intArr1), Identifier(intArr2)))), Println(Plus(StringLit(intArr1val: ),ArrayRead(Identifier(intArr1),IntLit(0)))), Println(Plus(StringLit(intArr2val: ),ArrayRead(Identifier(intArr2),IntLit(0)))), Assign(Identifier(string1),StringLit(1)), Assign(Identifier(string2),StringLit(2)), Assign(Identifier(unit),MethodCall(Self(),Identifier(swapString),List(Identifier(string1), Identifier(string2)))), Println(Plus(StringLit(string1: ),Identifier(string1))), Println(Plus(StringLit(string2: ),Identifier(string2))), Assign(Identifier(unit),MethodCall(Self(),Identifier(concatStringValue),List(Identifier(string1), Identifier(string2)))), Println(Plus(StringLit(string1val: ),Identifier(string1))), Println(Plus(StringLit(string2val: ),Identifier(string2))), Assign(Identifier(shape1),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(1)))), Assign(Identifier(shape2),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(2)))), Assign(Identifier(unit),MethodCall(Self(),Identifier(swapShape),List(Identifier(shape1), Identifier(shape2)))), Println(Plus(StringLit(shape1: ),MethodCall(Identifier(shape1),Identifier(getColor),List()))), Println(Plus(StringLit(shape2: ),MethodCall(Identifier(shape2),Identifier(getColor),List()))), Assign(Identifier(unit),MethodCall(Self(),Identifier(resetShape),List(Identifier(shape1), Identifier(shape2)))), Println(Plus(StringLit(shape1new: ),MethodCall(Identifier(shape1),Identifier(getColor),List()))), Println(Plus(StringLit(shape2set: ),MethodCall(Identifier(shape2),Identifier(getColor),List())))),IntLit(0)), MethodDecl(IntType(),Identifier(swapBool),List(Formal(BooleanType(),Identifier(n1)), Formal(BooleanType(),Identifier(n2))),List(VarDecl(BooleanType(),Identifier(temp))),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(IntType(),Identifier(swapInt),List(Formal(IntType(),Identifier(n1)), Formal(IntType(),Identifier(n2))),List(VarDecl(IntType(),Identifier(temp))),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(IntType(),Identifier(swapIntArr),List(Formal(IntArrayType(),Identifier(n1)), Formal(IntArrayType(),Identifier(n2))),List(VarDecl(IntArrayType(),Identifier(temp))),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(IntType(),Identifier(swapIntArrValue),List(Formal(IntArrayType(),Identifier(n1)), Formal(IntArrayType(),Identifier(n2))),List(VarDecl(IntType(),Identifier(temp))),List(Assign(Identifier(temp),ArrayRead(Identifier(n1),IntLit(0))), ArrayAssign(Identifier(n1),IntLit(0),ArrayRead(Identifier(n2),IntLit(0))), ArrayAssign(Identifier(n2),IntLit(0),Identifier(temp))),IntLit(0)), MethodDecl(IntType(),Identifier(swapString),List(Formal(StringType(),Identifier(n1)), Formal(StringType(),Identifier(n2))),List(VarDecl(StringType(),Identifier(temp))),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(IntType(),Identifier(concatStringValue),List(Formal(StringType(),Identifier(n1)), Formal(StringType(),Identifier(n2))),List(),List(Assign(Identifier(n1),Plus(Identifier(n1),Identifier(n2)))),IntLit(0)), MethodDecl(IntType(),Identifier(swapShape),List(Formal(Identifier(Shape),Identifier(n1)), Formal(Identifier(Shape),Identifier(n2))),List(VarDecl(Identifier(Shape),Identifier(temp))),List(Assign(Identifier(temp),Identifier(n1)), Assign(Identifier(n1),Identifier(n2)), Assign(Identifier(n2),Identifier(temp))),IntLit(0)), MethodDecl(IntType(),Identifier(resetShape),List(Formal(Identifier(Shape),Identifier(n1)), Formal(Identifier(Shape),Identifier(n2))),List(VarDecl(IntType(),Identifier(unit))),List(Assign(Identifier(n1),MethodCall(New(Identifier(Shape)),Identifier(init),List(StringLit(3)))), Assign(Identifier(unit),MethodCall(Identifier(n2),Identifier(setColor),List(StringLit(3))))),IntLit(0)))), ClassDecl(Identifier(Shape),None,List(VarDecl(StringType(),Identifier(color))),List(MethodDecl(Identifier(Shape),Identifier(init),List(Formal(StringType(),Identifier(col))),List(),List(Assign(Identifier(color),Identifier(col))),Self()), MethodDecl(StringType(),Identifier(getName),List(),List(),List(),StringLit(shape)), MethodDecl(IntType(),Identifier(draw),List(),List(),List(Println(StringLit(~))),IntLit(0)), MethodDecl(StringType(),Identifier(getColor),List(),List(),List(),Identifier(color)), MethodDecl(IntType(),Identifier(setColor),List(Formal(StringType(),Identifier(col))),List(),List(Assign(Identifier(color),Identifier(col))),IntLit(0)))), ClassDecl(Identifier(Rectangle),Some(Identifier(Shape)),List(VarDecl(IntType(),Identifier(x)), VarDecl(IntType(),Identifier(y))),List(MethodDecl(Identifier(Rectangle),Identifier(initRectangle),List(Formal(StringType(),Identifier(c)), Formal(IntType(),Identifier(a)), Formal(IntType(),Identifier(b))),List(VarDecl(Identifier(Shape),Identifier(unit))),List(Assign(Identifier(x),Identifier(a)), Assign(Identifier(y),Identifier(b)), Assign(Identifier(unit),MethodCall(Self(),Identifier(init),List(Identifier(c))))),Self()), MethodDecl(StringType(),Identifier(getName),List(),List(),List(),StringLit(rectangle)), MethodDecl(IntType(),Identifier(draw),List(),List(VarDecl(StringType(),Identifier(first)), VarDecl(StringType(),Identifier(second)), VarDecl(IntType(),Identifier(i))),List(Assign(Identifier(i),IntLit(0)), Assign(Identifier(first),StringLit( )), Assign(Identifier(second),StringLit(|)), While(LessThan(Identifier(i),Identifier(x)),Block(List(Assign(Identifier(first),Plus(Identifier(first),StringLit(-))), Assign(Identifier(second),Plus(Identifier(second),StringLit( ))), Assign(Identifier(i),Plus(Identifier(i),IntLit(1)))))), Assign(Identifier(second),Plus(Identifier(second),StringLit(|))), Println(Identifier(first)), Assign(Identifier(i),IntLit(0)), While(LessThan(Identifier(i),Identifier(y)),Block(List(Println(Identifier(second)), Assign(Identifier(i),Plus(Identifier(i),IntLit(1)))))), Println(Identifier(first))),IntLit(0)))), ClassDecl(Identifier(Square),Some(Identifier(Rectangle)),List(),List(MethodDecl(Identifier(Square),Identifier(initSquare),List(Formal(StringType(),Identifier(c)), Formal(IntType(),Identifier(side))),List(VarDecl(Identifier(Shape),Identifier(unit))),List(Assign(Identifier(unit),MethodCall(Self(),Identifier(initRectangle),List(Identifier(c), Identifier(side), Identifier(side))))),Self()), MethodDecl(StringType(),Identifier(getName),List(),List(),List(),StringLit(square)))), ClassDecl(Identifier(Circle),Some(Identifier(Shape)),List(),List(MethodDecl(Identifier(Circle),Identifier(initCircle),List(Formal(StringType(),Identifier(c))),List(VarDecl(Identifier(Shape),Identifier(unit))),List(Assign(Identifier(unit),MethodCall(Self(),Identifier(init),List(Identifier(c))))),Self()), MethodDecl(StringType(),Identifier(getName),List(),List(),List(),StringLit(circle)), MethodDecl(IntType(),Identifier(draw),List(),List(),List(Println(StringLit(O))),IntLit(0)), MethodDecl(IntType(),Identifier(drawTwice),List(),List(),List(),Plus(MethodCall(Self(),Identifier(draw),List()),MethodCall(Self(),Identifier(draw),List())))))))
